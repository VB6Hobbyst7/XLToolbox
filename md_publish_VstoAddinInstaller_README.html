<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Daniel&#39;s XL Toolbox NG: VstoAddinInstaller</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() {
    if ($('.searchresults').length > 0) { searchBox.DOMSearchField().focus(); }
  });
</script>
<link rel="search" href="search_opensearch.php?v=opensearch.xml" type="application/opensearchdescription+xml" title="Daniel's XL Toolbox NG"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="xltoolbox-blender-icon.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Daniel&#39;s XL Toolbox NG
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
          <div class="left">
            <form id="FSearchBox" action="search.php" method="get">
              <img id="MSearchSelect" src="search/mag.png" alt=""/>
              <input type="text" id="MSearchField" name="query" value="Search" size="20" accesskey="S" 
                     onfocus="searchBox.OnSearchFieldFocus(true)" 
                     onblur="searchBox.OnSearchFieldFocus(false)"/>
            </form>
          </div><div class="right"></div>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('md_publish_VstoAddinInstaller_README.html','');});
</script>
<div id="doc-content">
<div class="header">
  <div class="headertitle">
<div class="title">VstoAddinInstaller </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a href="http://www.jrsoftware.org/isinfo.php">InnoSetup</a> script to install and activate Visual Studio Tools for Office&reg; (VSTO) addins. VstoAddinInstaller makes heavy use of the InnoSetup Preprocessor (ISPP).</p>
<h2>Features </h2>
<ul>
<li>Installs Word&reg;, Excel&reg;, PowerPoint&reg;, or Outlook&reg; add-ins.</li>
<li>Downloads and installs .NET and VSTO runtimes if needed.</li>
<li>Checks if the target application is currently running and can automatically shut it down before proceeding with the installation process.</li>
<li>Can be used with an <code>/UPDATE</code> switch to silently shut down and restart the target application after the installation.</li>
<li>Modular structure makes it easy to keep custom configuration separate from the core functionality.</li>
</ul>
<p>The script is based on the installer used by <a href="https://www.xltoolbox.net">Daniel's XL Toolbox</a>.</p>
<h2>Requirements </h2>
<ul>
<li><a href="http://www.jrsoftware.org/isinfo.php">InnoSetup</a> with InnoSetup Preprocessor; ideally you would obtain the InnoSetup QuickStart Pack.</li>
<li><a href="http://mitrichsoftware.wordpress.com">InnoSetup Download Plugin</a> (takes care of downloading the .NET and VSTO runtime installers on the target system, if needed)</li>
<li>Visual Studio with Visual Studio Tools for Office (VSTO) (included in the 'Professional' editions).</li>
</ul>
<p>Some of these requirements should be fairly obvious...</p>
<h2>Instructions for use </h2>
<p>VstoAddinInstaller is designed to keep itself out of your way: After downloading and extracting the <a href="https://github.com/bovender/VstoAddinInstaller/archive/master.zip">archive</a> (or cloning the <a href="http://git-scm.com/downloads">Git</a> repository), you should have a dedicated folder 'VstoAddinInstaller' in your solution directory. You won't have to edit anything inside the VstoAddinInstaller directory. A configuration file can be copied from an example file <code>make-installer.dist.iss</code> from the <code>config-dist</code> subdirectory to your solution's directory, where you may want to include it in your own version control system.</p>
<p>A recommended folder structure is as follows: </p><pre class="fragment">    YourSolutionFolder
    ├── deploy                  &lt;-- custom folder, name it whatever you like
    │   ├── make-installer.iss  &lt;-- your custom config file for VstoAddinInstaller
    │   ├── VstoAddinInstaller  &lt;-- VstoAddinInstaller, e.g. as Git submodule
    │   │   ├── config-dist
    │   │   │   ├── make-installer.dist.iss  &lt;-- template for your make-installer.iss
    │   │   │   └── ...
    │   │   └── ...
    │   ├── setup-files         &lt;-- additional files, such as a license file
    │   │   └── ...
    │   └── releases            &lt;-- where the installer will be written to
    │       └── ...
    ├── YourProject
    │   ├── bin
    │   │   ├── Debug
    │   │   │   ├── YourProject.vsto   &lt;-- generated by Visual Studio
    │   │   │   └── ...
    │   │   └── Release
    │   │       ├── YourProject.vsto   &lt;-- generated by Visual Studio
    │   │       └── ...
    │   ├── YourProject.csproj
    │   └── ...
    ├── VERSION.TXT             &lt;-- text file containing the version number (optional)
    └── ...
</pre><h3>Cloning as Git submodule</h3>
<p>If you use <a href="http://git-scm.com/downloads">Git</a> as your version control, you can clone the VstoAddinInstaller respository into a submodule of your project repository: </p><pre class="fragment">git submodule add git@github.com:bovender/VstoAddinInstaller.git
</pre><p>You can then easily update the VstoAddinInstaller module by <em>changing into the directory</em> and issuing </p><pre class="fragment">git pull
</pre><p>Because the entire VstoAddinInstaller repository is contained in the submodule, you can switch between branches and use the <code>develop</code> branch rather than the <code>master</code> branch if you wish to do so.</p>
<h3>Configuring</h3>
<p>You need to make a copy of <code>config-dist\make-installer.dist.iss</code> and edit the contents. Ideally you would keep your copy of this file outside the <code>VstoAddinInstaller</code> directory, as shown above, so it does not get overwritten when you update VstoAddinInstaller.</p>
<p>You can rename the file to <code>make-installer.iss</code> or whatever you wish; the <code>.dist</code> part in the original file only serves to indicate that this is the distributed example file.</p>
<p>Follow along the instructions in your copy of <code>make-installer.dist.iss</code>.</p>
<p><b>Important</b>: Each installer produced with InnoSetup must have its own global unique identifier (GUID). Please insert your own GUID where indicated. You can generate a GUID using the corresponding command from the <code>Tools</code> menu in InnoSetup Studio, for example.</p>
<h3>Compiling the installer</h3>
<p>To compile the installer, simply run your copy of <code>make-installer.iss</code> through InnoSetup.</p>
<h3>Extending</h3>
<p>If you wish to add additional capabilities to your installer (e.g. InnoSetup tasks), have a look in the <code>config-dist</code> directory where you will find some example files.</p>
<p>Currently it is not possible to run additonal code during initialization of setup (<code>InitializeSetup</code>) or initialization of the wizard (<code>InitializeWizard</code>). I have been thinking about how to provide this capability, but have not yet have the time to implement it.</p>
<h2>Demos </h2>
<p>Demo projects are contained in the <a href="demo/">demo</a> directory.</p>
<p>In order to try out these demo installers, you must first build the corresponding projects in Visual Studio. The binaries are not contained in this repository!</p>
<h2>Further information </h2>
<p>For background information on the prerequisites of a VSTO add-in, see <a href="http://xltoolbox.net/blog/2015-01-30-net-vsto-add-ins-getting-prerequisites-right.html">http://xltoolbox.net/blog/2015-01-30-net-vsto-add-ins-getting-prerequisites-right.html</a>.</p>
<h2>Related </h2>
<p>This script is based on the related <a href="https://github.com/bovender/ExcelAddinInstaller">ExcelAddinInstaller</a>.</p>
<h2>Versioning </h2>
<p>VstoAddinInstaller is <a href="http://semver.org">semantically versioned</a> using Git tags.</p>
<p>In short: The version number follows the scheme <code>MAJOR.MINOR.PATCH</code>.</p>
<ul>
<li>An increase in the <code>MAJOR</code> version number signifies API-breaking changes, i.e., if you decide to upgrade, you <em>must</em> adjust your local copy of <code>make-install.iss</code>.</li>
<li>An increase in the <code>MINOR</code> version number denotes new or improved features. You can upgrade without adjusting your <code>make-install.iss</code>.</li>
<li>The <code>PATCH</code> number is increased with bug fixes. Again, no need to edit your copy of <code>make-install.iss</code>.</li>
</ul>
<h2>License </h2>
<p>Published under the [Apache License, Version 2.0](LICENSE). </p><pre class="fragment">    Copyright (C) 2016 Daniel Kraus (bovender) &lt;http://github.com/bovender&gt;

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
</pre><p>Microsoft®, Windows®, Office, and Excel&reg;, PowerPoint&reg;, and Outlook&reg; are either registered trademarks or trademarks of Microsoft Corporation in the United States and/or other countries. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon May 30 2016 17:16:58 for Daniel&#39;s XL Toolbox NG by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
